{% extends 'upload/base.html' %}


{% block content %}
  <form action="{% url 'index' %}" method="post" enctype='multipart/form-data'>
    {% csrf_token %}
    <input type="file" accept=".csv" name="file" required></input>
    <input type="submit" value="Submit">
  </form>
  <div class="list">
    <h2>Uploaded forms</h2>
    <table>
      <tr>
        <th>ID</th>
        <th>Date uploaded</th>
        <th>Upload method</th>
        <th>File</th>
        <th>Status</th>
        {% comment %} <th>Order</th>
        <th>Payment</th> {% endcomment %}
      </tr>
      {% if uploads %}
        {% for upload in uploads %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ upload.date_uploaded }}</td>
            <td>{{ upload.upload_method }}</td>
            <td>
              {% if upload.file_upload %}
                <a href="/media/{{upload.file_upload.file}}">{{ upload.file_upload.file }}</a>
              {% else %}
                -
              {% endif %}
            </td>
            <td>
              {% if upload.uploadstatus %}
                {{ upload.uploadstatus.status.name }}
              {% else %} 
                -
              {% endif %}
            </td>
            {% comment %} <td><a href="{% url 'order' file.order.id %}">{{ file.order.id }}</a></td> {% endcomment %}
            {% comment %} <td><a href="{% url 'payment' file.payment.id %}">{{ file.payment.id }}</a></td> {% endcomment %}
          </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="2000" style="text-align: center;">No uploaded forms<td>
        </tr>
      {% endif %}
    </table>
  </div>
{% endblock content %}
